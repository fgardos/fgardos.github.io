<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Análisis de variables categóricas con R</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Análisis de variables categóricas con R</h1>

<p><a href="http://bioinfo.cipf.es/" title="webpage of department">Francisco García García</a> <em>(2014-17-12)</em>  </p>

<hr/>

<h3>0. Introducción</h3>

<h3>1. Tablas de contingencia</h3>

<h3>2. Prueba chi-cuadrado</h3>

<h3>3. Ejercicios</h3>

<h3>4. Bibliografía y enlaces de interés</h3>

<hr/>

<p><br />
<br />
<br /></p>

<h2>0. Introducción</h2>

<p>Para conocer la relación entre dos variables categóricas utilizaremos:</p>

<ul>
<li><strong>Tablas de contingencia</strong> para describir esta relación a nivel muestral.</li>
<li><strong>Test de chi-cuadrado</strong> para hacer inferencia sobre la relación entre ambas variables.<br/></li>
</ul>

<p><br />
<br /></p>

<h2>1. Tablas de contingencia</h2>

<p>Comenzamos leyendo la base de datos <strong>riesgos</strong>:</p>

<pre><code class="r">datos &lt;- read.csv(&quot;riesgos.csv&quot;, header = T, sep = &quot;\t&quot;)
</code></pre>

<pre><code>#&gt; Warning in file(file, &quot;rt&quot;): cannot open file &#39;riesgos.csv&#39;: No such file
#&gt; or directory
</code></pre>

<pre><code>#&gt; Error in file(file, &quot;rt&quot;): cannot open the connection
</code></pre>

<p>Echamos un vistazo a la estructura de los datos:</p>

<pre><code class="r">str(datos)
</code></pre>

<pre><code>#&gt; Error in str(datos): object &#39;datos&#39; not found
</code></pre>

<pre><code class="r">head(datos)
</code></pre>

<pre><code>#&gt; Error in head(datos): object &#39;datos&#39; not found
</code></pre>

<pre><code class="r">tail(datos)
</code></pre>

<pre><code>#&gt; Error in tail(datos): object &#39;datos&#39; not found
</code></pre>

<p>Con la función <strong>attach</strong> hacemos accesible la base de datos seleccionada:</p>

<pre><code class="r">attach(datos) 
</code></pre>

<pre><code>#&gt; Error in attach(datos): object &#39;datos&#39; not found
</code></pre>

<p>Describimos cada una de las variables categóricas: <strong>jornada</strong>, <strong>carfisi</strong> y <strong>expquímica</strong>:</p>

<pre><code class="r">table(jornada)
</code></pre>

<pre><code>#&gt; Error in table(jornada): object &#39;jornada&#39; not found
</code></pre>

<pre><code class="r">table(carfisi)
</code></pre>

<pre><code>#&gt; Error in table(carfisi): object &#39;carfisi&#39; not found
</code></pre>

<pre><code class="r">table(expquímica)
</code></pre>

<pre><code>#&gt; Error in table(expquímica): object &#39;expquímica&#39; not found
</code></pre>

<p>Nos interesa describir la relación entre <strong>jornada</strong> y cada uno de los dos riesgos mencionados anteriormente. 
Utilizaremos el comando <strong>table</strong> para dos variables que nos proporciona una <strong>tabla de contingencia</strong>:</p>

<pre><code class="r">tabla1 &lt;- table(jornada,carfisi)
</code></pre>

<pre><code>#&gt; Error in table(jornada, carfisi): object &#39;jornada&#39; not found
</code></pre>

<pre><code class="r">tabla1
</code></pre>

<pre><code>#&gt; Error in eval(expr, envir, enclos): object &#39;tabla1&#39; not found
</code></pre>

<p>También nos gustaría visualizar esta relación: </p>

<pre><code class="r">plot(tabla1, col = c(&quot;red&quot;, &quot;blue&quot;), main = &quot;jornada vs. carga física&quot;)
</code></pre>

<pre><code>#&gt; Error in plot(tabla1, col = c(&quot;red&quot;, &quot;blue&quot;), main = &quot;jornada vs. carga física&quot;): object &#39;tabla1&#39; not found
</code></pre>

<pre><code class="r">tabla2 &lt;- table(jornada, expquímica)
</code></pre>

<pre><code>#&gt; Error in table(jornada, expquímica): object &#39;jornada&#39; not found
</code></pre>

<pre><code class="r">tabla2
</code></pre>

<pre><code>#&gt; Error in eval(expr, envir, enclos): object &#39;tabla2&#39; not found
</code></pre>

<pre><code class="r">plot(tabla2, col = c(&quot;red&quot;, &quot;blue&quot;), main = &quot;jornada vs. exposición química&quot;)
</code></pre>

<pre><code>#&gt; Error in plot(tabla2, col = c(&quot;red&quot;, &quot;blue&quot;), main = &quot;jornada vs. exposición química&quot;): object &#39;tabla2&#39; not found
</code></pre>

<p>A partir de los datos que nos ofrece la muestra, ¿crees que hay una relación entre el tipo de <strong>jornada</strong> y estar expuesto a <strong>carga física</strong>? 
 ¿Qué opinas de la relación entre el tipo de <strong>jornada</strong> y  <strong>exposición química</strong>?
<br />
<br /></p>

<h2>2. Prueba chi-cuadrado</h2>

<h3>2.1. Independencia de dos variables categóricas.</h3>

<p>En el apartado anterior detectamos que parece existir una relación entre ambas variables. Las personas con jornada completa tienen
una mayor exposición a carga física y menor exposición química que las personas con jornada parcial. </p>

<p>¿Estas diferencias serán estadísticamente significativas? Utilizaremos la prueba de <strong>chi-cuadrado</strong>:</p>

<pre><code class="r">chisq.test(tabla1)
</code></pre>

<pre><code>#&gt; Error in is.data.frame(x): object &#39;tabla1&#39; not found
</code></pre>

<pre><code class="r">chisq.test(tabla2)
</code></pre>

<pre><code>#&gt; Error in is.data.frame(x): object &#39;tabla2&#39; not found
</code></pre>

<p>Con un nivel de significación de 0.05, no podríamos rechazar en ninguno de los dos escenarios la hipótesis nula, 
luego consideraremos que hay independencia entre ambas variables, es decir, el tipo de contrato no está asociado a una
mayor exposición química o carga física.</p>

<h3>2.2. Contraste de homogeneidad de proporciones.</h3>

<p>Si queremos comparar dos proporciones poblaciones, es posible el tes de comparar proporciones basado en los procedimiento <strong>z</strong>. 
¿Y si disponemos de más de 2 proporciones? Para esta situación, también es posible utilizar el test de chi-cuadrado. Lo vemos con un ejemplo:</p>

<p>Queremos comparar si las proporciones de presencia de <strong>carga física</strong> en tres poblaciones de trabajadores (A, B, C) son iguales 
o diferentes.  Para ello, se seleccionaron 3 muestras aleatorias, cada una correspondiente a estas poblaciones. Se obtuvieron 
los siguiente resultados:</p>

<ul>
<li>Población A:  400 personas manifestaron <strong>carga física</strong> de un total de 1380.</li>
<li>Población B:  416 personas manifestaron <strong>carga física</strong> de un total de 1823.</li>
<li>Población A:  188 personas manifestaron <strong>carga física</strong> de un total de 1168.</li>
</ul>

<p>Calculamos las proporciones de personas con <strong>carga física</strong> en cada uno de los grupos:</p>

<pre><code class="r">400/1780
</code></pre>

<pre><code>#&gt; [1] 0.2247191
</code></pre>

<pre><code class="r">416/2239
</code></pre>

<pre><code>#&gt; [1] 0.1857972
</code></pre>

<pre><code class="r">188/1356
</code></pre>

<pre><code>#&gt; [1] 0.1386431
</code></pre>

<p>¿Observamos diferencias entre las proporcionales a nivel muestral?</p>

<p>Comprobaremos si esas diferencias son estadísticamente significativas utilizando el test de chi-cuadrado. El primer paso
será generar una  tabla de contingencia:</p>

<pre><code class="r">fila1 &lt;- c(400,1380)
fila2 &lt;- c(416,1823)
fila3 &lt;- c(188,1168)
tabla=rbind(fila1,fila2,fila3)
colnames(tabla) &lt;- c(&quot;con carfisica&quot;, &quot;sin carfisica&quot;)
tabla  
</code></pre>

<pre><code>#&gt;       con carfisica sin carfisica
#&gt; fila1           400          1380
#&gt; fila2           416          1823
#&gt; fila3           188          1168
</code></pre>

<p>Resolvemos el contraste en R:</p>

<pre><code class="r">resultados &lt;- chisq.test(tabla)
names(resultados)
</code></pre>

<pre><code>#&gt; [1] &quot;statistic&quot; &quot;parameter&quot; &quot;p.value&quot;   &quot;method&quot;    &quot;data.name&quot; &quot;observed&quot; 
#&gt; [7] &quot;expected&quot;  &quot;residuals&quot; &quot;stdres&quot;
</code></pre>

<pre><code class="r">resultados$observed
</code></pre>

<pre><code>#&gt;       con carfisica sin carfisica
#&gt; fila1           400          1380
#&gt; fila2           416          1823
#&gt; fila3           188          1168
</code></pre>

<pre><code class="r">resultados$expected
</code></pre>

<pre><code>#&gt;       con carfisica sin carfisica
#&gt; fila1      332.4874      1447.513
#&gt; fila2      418.2244      1820.776
#&gt; fila3      253.2882      1102.712
</code></pre>

<pre><code class="r">resultados
</code></pre>

<pre><code>#&gt; 
#&gt;  Pearson&#39;s Chi-squared test
#&gt; 
#&gt; data:  tabla
#&gt; X-squared = 37.5663, df = 2, p-value = 6.959e-09
</code></pre>

<p>Interpreta los resultados obtenidos:</p>

<ul>
<li>¿Cuál es el estadístico de contraste?, ¿cómo se calcula?, ¿cuál sería el rango del estadístico chi-cuadrado?</li>
<li>¿Qué p-valor obtenemos? </li>
<li>En el contexto del problema, ¿cómo interpretaríamos los resultados obtenidos en el test estadístico?</li>
</ul>

<p><br />
<br /></p>

<h2>3. Ejercicios</h2>

<p>En la base de datos <strong>estres.csv</strong> se incluye información sobre los niveles de estrés de un grupo de trabajadores, así
como otras variables de interés.</p>

<p>Realiza las siguientes actividades en R:</p>

<ul>
<li><strong>A</strong>. Lee la base de datos <em>estres</em>,  examina la estructura de los datos (<em>str</em>) y utiliza la función <em>attach</em> 
para hacerla accesible y trabajar más cómodamente con sus variables. ¿Qué variables son <em>factor</em>? ¿Y qué variables son <em>integer</em>?</li>
<li><strong>B</strong>. Describe la relación entre las variables <strong>jornada</strong> y <strong>genero</strong> utilizando una <strong>tabla de contingencia</strong> y un gráfico.
¿Se observa una relación de dependencia entre ambas?.
Aplica el test de chi-cuadrado para valorar si esta relación es estadísticamente significativa.
<br />
<br /></li>
</ul>

<h2>4. Bibliografía y enlaces de interés:</h2>

<ul>
<li><p><a href="http://www.antonibosch.com/system/downloads/487/original/EC-MOORE2_Contenido.pdf?1358332517">David S. Moore. Estadística aplicada básica. Editorial Antoni Bosch.</a>  Manual de Estadística Básica.</p></li>
<li><p><a href="http://www.statmethods.net/">Quick-R</a>   Web con recursos para trabajar con R.</p></li>
<li><p><a href="http://www.r-tutor.com/">r-tutor</a>  An R Introduction to Statistics.</p></li>
</ul>

<hr/>

</body>

</html>
